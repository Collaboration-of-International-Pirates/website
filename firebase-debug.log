[debug] [2024-01-09T20:52:35.567Z] ----------------------------------------------------------------------
[debug] [2024-01-09T20:52:35.569Z] Command:       /usr/local/bin/firebase /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/bin/firebase emulators:start
[debug] [2024-01-09T20:52:35.569Z] CLI Version:   13.0.2
[debug] [2024-01-09T20:52:35.569Z] Platform:      linux
[debug] [2024-01-09T20:52:35.569Z] Node Version:  v18.5.0
[debug] [2024-01-09T20:52:35.570Z] Time:          Tue Jan 09 2024 20:52:35 GMT+0000 (Greenwich Mean Time)
[debug] [2024-01-09T20:52:35.570Z] ----------------------------------------------------------------------
[debug] 
[debug] [2024-01-09T20:52:35.654Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2024-01-09T20:52:35.654Z] > authorizing via signed-in user (maberwilliam@gmail.com)
[debug] [2024-01-09T20:52:35.689Z] openjdk version "17.0.9" 2023-10-17

[debug] [2024-01-09T20:52:35.690Z] OpenJDK Runtime Environment (build 17.0.9+9-Ubuntu-123.10)
OpenJDK 64-Bit Server VM (build 17.0.9+9-Ubuntu-123.10, mixed mode, sharing)

[debug] [2024-01-09T20:52:35.693Z] Parsed Java major version: 17
[info] i  emulators: Starting emulators: auth, functions, firestore, hosting, storage, eventarc, extensions {"metadata":{"emulator":{"name":"hub"},"message":"Starting emulators: auth, functions, firestore, hosting, storage, eventarc, extensions"}}
[debug] [2024-01-09T20:52:35.696Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/ptate-df901 [none]
[debug] [2024-01-09T20:52:35.949Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/ptate-df901 200
[debug] [2024-01-09T20:52:35.950Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/ptate-df901 {"projectId":"ptate-df901","projectNumber":"795297920122","displayName":"pirate party","name":"projects/ptate-df901","resources":{"hostingSite":"ptate-df901","storageBucket":"ptate-df901.appspot.com","locationId":"us-central"},"state":"ACTIVE","etag":"1_d0172919-a97c-4a4b-9caa-1f6911ef4383"}
[warn] ⚠  hosting: The hosting emulator is configured but there is no hosting configuration. Have you run firebase init hosting? {"metadata":{"emulator":{"name":"hosting"},"message":"The hosting emulator is configured but there is no hosting configuration. Have you run \u001b[1mfirebase init hosting\u001b[22m?"}}
[debug] [2024-01-09T20:52:35.967Z] [logging] Logging Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-01-09T20:52:35.967Z] [auth] Authentication Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-01-09T20:52:35.967Z] [firestore] Firestore Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-01-09T20:52:35.967Z] [firestore.websocket] websocket server for firestore only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-01-09T20:52:35.967Z] [storage] Storage Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-01-09T20:52:35.968Z] assigned listening specs for emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8081}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}],"storage":[{"address":"127.0.0.1","family":"IPv4","port":9199}]},"metadata":{"message":"assigned listening specs for emulators"}}
[debug] [2024-01-09T20:52:35.979Z] [hub] writing locator at /tmp/hub-ptate-df901.json
[debug] [2024-01-09T20:52:35.985Z] [Extensions] Started Extensions emulator, this is a noop.
[debug] [2024-01-09T20:52:35.985Z] [functions] Functions Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-01-09T20:52:35.986Z] [eventarc] Eventarc Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-01-09T20:52:35.986Z] late-assigned ports for functions and eventarc emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8081}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}],"storage":[{"address":"127.0.0.1","family":"IPv4","port":9199}],"functions":[{"address":"127.0.0.1","family":"IPv4","port":5001}],"eventarc":[{"address":"127.0.0.1","family":"IPv4","port":9299}]},"metadata":{"message":"late-assigned ports for functions and eventarc emulators"}}
[warn] ⚠  functions: The following emulators are not running, calls to these services from the Functions emulator will affect production: database, hosting, pubsub {"metadata":{"emulator":{"name":"functions"},"message":"The following emulators are not running, calls to these services from the Functions emulator will affect production: \u001b[1mdatabase, hosting, pubsub\u001b[22m"}}
[debug] [2024-01-09T20:52:35.989Z] defaultcredentials: writing to file /home/lucy/.config/firebase/maberwilliam_gmail_com_application_default_credentials.json
[debug] [2024-01-09T20:52:35.990Z] Setting GAC to /home/lucy/.config/firebase/maberwilliam_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to /home/lucy/.config/firebase/maberwilliam_gmail_com_application_default_credentials.json"}}
[debug] [2024-01-09T20:52:35.991Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/ptate-df901/adminSdkConfig [none]
[debug] [2024-01-09T20:52:36.532Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/ptate-df901/adminSdkConfig 200
[debug] [2024-01-09T20:52:36.532Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/ptate-df901/adminSdkConfig {"projectId":"ptate-df901","storageBucket":"ptate-df901.appspot.com","locationId":"us-central"}
[debug] [2024-01-09T20:52:36.577Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-01-09T20:52:36.578Z] Ignoring unsupported arg: single_project_mode_error {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: single_project_mode_error"}}
[debug] [2024-01-09T20:52:36.578Z] Starting Firestore Emulator with command {"binary":"java","args":["-Dgoogle.cloud_firestore.debug_log_level=FINE","-Duser.language=en","-jar","/home/lucy/.cache/firebase/emulators/cloud-firestore-emulator-v1.18.2.jar","--host","127.0.0.1","--port",8081,"--websocket_port",9150,"--project_id","ptate-df901","--rules","/home/lucy/Code/Priaite_Party_UK/website/firestore.rules","--single_project_mode",true,"--functions_emulator","127.0.0.1:5001"],"optionalArgs":["port","webchannel_port","host","rules","websocket_port","functions_emulator","seed_from_export","project_id","single_project_mode"],"joinArgs":false} {"metadata":{"emulator":{"name":"firestore"},"message":"Starting Firestore Emulator with command {\"binary\":\"java\",\"args\":[\"-Dgoogle.cloud_firestore.debug_log_level=FINE\",\"-Duser.language=en\",\"-jar\",\"/home/lucy/.cache/firebase/emulators/cloud-firestore-emulator-v1.18.2.jar\",\"--host\",\"127.0.0.1\",\"--port\",8081,\"--websocket_port\",9150,\"--project_id\",\"ptate-df901\",\"--rules\",\"/home/lucy/Code/Priaite_Party_UK/website/firestore.rules\",\"--single_project_mode\",true,\"--functions_emulator\",\"127.0.0.1:5001\"],\"optionalArgs\":[\"port\",\"webchannel_port\",\"host\",\"rules\",\"websocket_port\",\"functions_emulator\",\"seed_from_export\",\"project_id\",\"single_project_mode\"],\"joinArgs\":false}"}}
[info] i  firestore: Firestore Emulator logging to firestore-debug.log {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator logging to \u001b[1mfirestore-debug.log\u001b[22m"}}
[debug] [2024-01-09T20:52:37.300Z] Jan 09, 2024 8:52:37 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketServer start
INFO: Started WebSocket server on ws://127.0.0.1:9150
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:52:37 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketServer start\nINFO: Started WebSocket server on ws://127.0.0.1:9150\n"}}
[debug] [2024-01-09T20:52:37.315Z] API endpoint: http:// {"metadata":{"emulator":{"name":"firestore"},"message":"API endpoint: http://"}}
[debug] [2024-01-09T20:52:37.315Z] 127.0.0.1:8081
If you are using a library that supports the FIRESTORE_EMULATOR_HOST environment variable, run:

   export FIRESTORE_EMULATOR_HOST=127.0.0.1:8081

Dev App Server is now running.

 {"metadata":{"emulator":{"name":"firestore"},"message":"127.0.0.1:8081\nIf you are using a library that supports the FIRESTORE_EMULATOR_HOST environment variable, run:\n\n   export FIRESTORE_EMULATOR_HOST=127.0.0.1:8081\n\nDev App Server is now running.\n\n"}}
[info] ✔  firestore: Firestore Emulator UI websocket is running on 9150. {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator UI websocket is running on 9150."}}
[debug] [2024-01-09T20:52:43.740Z] Ignoring unsupported arg: port {"metadata":{"emulator":{"name":"storage"},"message":"Ignoring unsupported arg: port"}}
[warn] ⚠  Unexpected 'request' in /home/lucy/Code/Priaite_Party_UK/website/storage.rules:98 {"metadata":{"emulator":{"name":"storage"},"message":"Unexpected 'request' in /home/lucy/Code/Priaite_Party_UK/website/storage.rules:98"}}
[debug] [2024-01-09T20:52:44.216Z] Temp file directory for storage emulator: /tmp/firebase/storage/blobs {"metadata":{"emulator":{"name":"storage"},"message":"Temp file directory for storage emulator: /tmp/firebase/storage/blobs"}}
[debug] [2024-01-09T20:52:44.225Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-01-09T20:52:44.225Z] Ignoring unsupported arg: port {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: port"}}
[debug] [2024-01-09T20:52:44.225Z] Starting Emulator UI with command {"binary":"node","args":["/home/lucy/.cache/firebase/emulators/ui-v1.11.7/server/server.js"],"optionalArgs":[],"joinArgs":false} {"metadata":{"emulator":{"name":"ui"},"message":"Starting Emulator UI with command {\"binary\":\"node\",\"args\":[\"/home/lucy/.cache/firebase/emulators/ui-v1.11.7/server/server.js\"],\"optionalArgs\":[],\"joinArgs\":false}"}}
[info] i  ui: Emulator UI logging to ui-debug.log {"metadata":{"emulator":{"name":"ui"},"message":"Emulator UI logging to \u001b[1mui-debug.log\u001b[22m"}}
[debug] [2024-01-09T20:52:44.399Z] Web / API server started at 127.0.0.1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at 127.0.0.1:4000\n"}}
[debug] [2024-01-09T20:52:44.400Z] Web / API server started at ::1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at ::1:4000\n"}}
[debug] [2024-01-09T20:52:44.497Z] [Extensions] Connecting Extensions emulator, this is a noop.
[info] i  functions: Watching "/home/lucy/Code/Priaite_Party_UK/website/functions" for Cloud Functions... {"metadata":{"emulator":{"name":"functions"},"message":"Watching \"/home/lucy/Code/Priaite_Party_UK/website/functions\" for Cloud Functions..."}}
[debug] [2024-01-09T20:52:44.508Z] Customer code is not Node
[debug] [2024-01-09T20:52:44.510Z] Customer code is not Python code.
[error] ⬢  functions: Failed to load function definition from source: FirebaseError: Could not detect language for functions at /home/lucy/Code/Priaite_Party_UK/website/functions {"metadata":{"emulator":{"name":"functions"},"message":"Failed to load function definition from source: FirebaseError: Could not detect language for functions at /home/lucy/Code/Priaite_Party_UK/website/functions"}}
[info] i  functions: Watching "/home/lucy/Code/Priaite_Party_UK/website/ppuk" for Cloud Functions... {"metadata":{"emulator":{"name":"functions"},"message":"Watching \"/home/lucy/Code/Priaite_Party_UK/website/ppuk\" for Cloud Functions..."}}
[debug] [2024-01-09T20:52:44.516Z] Validating nodejs source
[warn] ⚠  functions: Couldn't find firebase-functions package in your source code. Have you run 'npm install'? 
[debug] [2024-01-09T20:52:44.520Z] getFunctionsSDKVersion encountered error: Cannot find module 'firebase-functions'
Require stack:
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/node/versioning.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/node/index.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/index.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/gcp/cloudfunctions.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/backend.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/emulator/functionsEmulatorShared.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/emulator/functionsEmulator.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/emulator/controller.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/emulator/commandUtils.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/commands/database-get.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/commands/index.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/index.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/bin/firebase.js {"code":"MODULE_NOT_FOUND","requireStack":["/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/node/versioning.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/node/index.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/index.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/gcp/cloudfunctions.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/backend.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/emulator/functionsEmulatorShared.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/emulator/functionsEmulator.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/emulator/controller.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/emulator/commandUtils.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/commands/database-get.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/commands/index.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/index.js","/home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/bin/firebase.js"]}
[debug] [2024-01-09T20:52:44.522Z] checkFunctionsSDKVersion encountered error: Invalid Version:  {}
[debug] [2024-01-09T20:52:44.524Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "index.js",
  "dependencies": {
    "firebase-admin": "^11.8.0",
    "firebase-functions": "^4.3.1"
  },
  "devDependencies": {
    "firebase-functions-test": "^3.1.0"
  },
  "private": true
}
[debug] [2024-01-09T20:52:44.524Z] Building nodejs source
[debug] [2024-01-09T20:52:44.526Z] Failed to find version of module node: reached end of search path /home/lucy/Code/Priaite_Party_UK/website/ppuk/node_modules
[info] ✔  functions: Using node@18 from host. 
[debug] [2024-01-09T20:52:44.532Z] Could not parse firebase-functions version '' into semver. Falling back to parseTriggers.
[error] ⬢  functions: Failed to load function definition from source: FirebaseError: Error parsing triggers: Cannot find module 'firebase-functions/v2/https'
Require stack:
- /home/lucy/Code/Priaite_Party_UK/website/ppuk/index.js
- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/node/triggerParser.js
1) If you want to compile the package/file into executable, please pay attention to compilation warnings and specify a literal in 'require' call. 2) If you don't want to compile the package/file into executable and want to 'require' it from filesystem (likely plugin), specify an absolute path in 'require' call using process.cwd() or process.execPath.

Try running "npm install" in your functions directory before deploying. {"metadata":{"emulator":{"name":"functions"},"message":"Failed to load function definition from source: FirebaseError: Error parsing triggers: Cannot find module 'firebase-functions/v2/https'\nRequire stack:\n- /home/lucy/Code/Priaite_Party_UK/website/ppuk/index.js\n- /home/lucy/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/node/triggerParser.js\n1) If you want to compile the package/file into executable, please pay attention to compilation warnings and specify a literal in 'require' call. 2) If you don't want to compile the package/file into executable and want to 'require' it from filesystem (likely plugin), specify an absolute path in 'require' call using process.cwd() or process.execPath.\n\nTry running \"npm install\" in your functions directory before deploying."}}
[info] 
┌─────────────────────────────────────────────────────────────┐
│ ✔  All emulators ready! It is now safe to connect your app. │
│ i  View Emulator UI at http://127.0.0.1:4000/               │
└─────────────────────────────────────────────────────────────┘

┌────────────────┬──────────────────────────────────┬──────────────────────────────────┐
│ Emulator       │ Host:Port                        │ View in Emulator UI              │
├────────────────┼──────────────────────────────────┼──────────────────────────────────┤
│ Authentication │ 127.0.0.1:9099                   │ http://127.0.0.1:4000/auth       │
├────────────────┼──────────────────────────────────┼──────────────────────────────────┤
│ Functions      │ 127.0.0.1:5001                   │ http://127.0.0.1:4000/functions  │
├────────────────┼──────────────────────────────────┼──────────────────────────────────┤
│ Firestore      │ 127.0.0.1:8081                   │ http://127.0.0.1:4000/firestore  │
├────────────────┼──────────────────────────────────┼──────────────────────────────────┤
│ Hosting        │ Failed to initialize (see above) │                                  │
├────────────────┼──────────────────────────────────┼──────────────────────────────────┤
│ Storage        │ 127.0.0.1:9199                   │ http://127.0.0.1:4000/storage    │
├────────────────┼──────────────────────────────────┼──────────────────────────────────┤
│ Eventarc       │ 127.0.0.1:9299                   │ n/a                              │
├────────────────┼──────────────────────────────────┼──────────────────────────────────┤
│ Extensions     │ 127.0.0.1:5001                   │ http://127.0.0.1:4000/extensions │
└────────────────┴──────────────────────────────────┴──────────────────────────────────┘
  Emulator Hub running at 127.0.0.1:4400
  Other reserved ports: 4500, 9150
┌─────────────────────────┬───────────────┬─────────────────────┐
│ Extension Instance Name │ Extension Ref │ View in Emulator UI │
└─────────────────────────┴───────────────┴─────────────────────┘
Issues? Report them at https://github.com/firebase/firebase-tools/issues and attach the *-debug.log files.
 
[debug] [2024-01-09T20:52:46.311Z] Jan 09, 2024 8:52:46 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler initChannel
INFO: Connected to new websocket client
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:52:46 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler initChannel\nINFO: Connected to new websocket client\n"}}
[debug] [2024-01-09T20:52:58.081Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast [none]
[debug] [2024-01-09T20:52:58.081Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"eventId":"992b2347-5c63-42a8-a99b-95c08dc519e8","eventType":"providers/firebase.auth/eventTypes/user.create","resource":{"name":"projects/ptate-df901","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-01-09T20:52:58.081Z","data":{"uid":"jeHnqPiE2DQw7vwwTnQ1PgE54SE8","email":"maberwilliam@gmail.com","emailVerified":false,"metadata":{"creationTime":"2024-01-09T20:52:58.080Z","lastSignInTime":"2024-01-09T20:52:58.080Z"},"customClaims":{},"providerData":[{"providerId":"password","email":"maberwilliam@gmail.com","federatedId":"maberwilliam@gmail.com","rawId":"maberwilliam@gmail.com"}]}}
[debug] [2024-01-09T20:52:58.088Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast 200
[debug] [2024-01-09T20:52:58.089Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-01-09T20:52:58.119Z] Jan 09, 2024 8:52:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:52:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:52:58.483Z] Jan 09, 2024 8:52:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:52:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:52:58.500Z] Jan 09, 2024 8:52:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:52:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:52:58.570Z] Jan 09, 2024 8:52:58 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:1045)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:955)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:942)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.write(CloudFirestoreV1.java:930)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:210)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:138)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:93)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:26)
	at com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:160)
	at com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:130)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.onMessage(ChannelInternalImpl.java:525)
	at com.google.net.webchannel.server.v8.ForwardChannel.deliverMessage(ForwardChannel.java:114)
	at com.google.net.webchannel.server.v8.ForwardChannel.processPendingRequest(ForwardChannel.java:93)
	at com.google.net.webchannel.server.v8.ForwardChannel.consume(ForwardChannel.java:67)
	at com.google.net.webchannel.server.v8.ForwardChannel.add(ForwardChannel.java:60)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.handleRequestBody(ChannelInternalImpl.java:290)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.processSessionRequest(ChannelInternalImpl.java:357)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.handle(ChannelInternalImpl.java:172)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.consume(ChannelInternalImpl.java:91)
	at com.google.net.webchannel.server.common.ChannelProcessor.run(ChannelProcessor.java:86)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 22 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:52:58 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:1045)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:955)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:942)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.write(CloudFirestoreV1.java:930)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:210)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:138)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:93)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:26)\n\tat com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:160)\n\tat com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:130)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.onMessage(ChannelInternalImpl.java:525)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.deliverMessage(ForwardChannel.java:114)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.processPendingRequest(ForwardChannel.java:93)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.consume(ForwardChannel.java:67)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.add(ForwardChannel.java:60)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.handleRequestBody(ChannelInternalImpl.java:290)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.processSessionRequest(ChannelInternalImpl.java:357)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.handle(ChannelInternalImpl.java:172)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.consume(ChannelInternalImpl.java:91)\n\tat com.google.net.webchannel.server.common.ChannelProcessor.run(ChannelProcessor.java:86)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 22 more\n\n"}}
[debug] [2024-01-09T20:52:58.581Z] Jan 09, 2024 8:52:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:52:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:52:58.585Z] Jan 09, 2024 8:52:58 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose
INFO: channel closed
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:52:58 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose\nINFO: channel closed\n"}}
[debug] [2024-01-09T20:52:58.594Z] Jan 09, 2024 8:52:58 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose
INFO: channel closed
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:52:58 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose\nINFO: channel closed\n"}}
[debug] [2024-01-09T20:53:01.395Z] Jan 09, 2024 8:53:01 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler channelClosed
INFO: Websocket client disconnected
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:01 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler channelClosed\nINFO: Websocket client disconnected\n"}}
[debug] [2024-01-09T20:53:01.532Z] Jan 09, 2024 8:53:01 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler initChannel
INFO: Connected to new websocket client
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:01 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler initChannel\nINFO: Connected to new websocket client\n"}}
[debug] [2024-01-09T20:53:03.693Z] Jan 09, 2024 8:53:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:53:03.781Z] Jan 09, 2024 8:53:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:53:03.830Z] Jan 09, 2024 8:53:03 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:03 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:53:03.839Z] Jan 09, 2024 8:53:03 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:03 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:53:16.253Z] Jan 09, 2024 8:53:16 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:16 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:53:16.257Z] Jan 09, 2024 8:53:16 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:16 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:53:26.198Z] Jan 09, 2024 8:53:26 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:26 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:53:26.203Z] Jan 09, 2024 8:53:26 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:26 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:53:36.218Z] Jan 09, 2024 8:53:36 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:36 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:53:36.219Z] Jan 09, 2024 8:53:36 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:36 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:53:46.256Z] Jan 09, 2024 8:53:46 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:46 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:53:46.265Z] Jan 09, 2024 8:53:46 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:46 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:53:56.315Z] Jan 09, 2024 8:53:56 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:56 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:53:56.317Z] Jan 09, 2024 8:53:56 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:53:56 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:54:06.346Z] Jan 09, 2024 8:54:06 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:06 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:54:06.349Z] Jan 09, 2024 8:54:06 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:06 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:54:16.385Z] Jan 09, 2024 8:54:16 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:16 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:54:16.389Z] Jan 09, 2024 8:54:16 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:16 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:54:26.421Z] Jan 09, 2024 8:54:26 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:26 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:54:26.425Z] Jan 09, 2024 8:54:26 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:26 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:54:36.460Z] Jan 09, 2024 8:54:36 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:36 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:54:36.466Z] Jan 09, 2024 8:54:36 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:36 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:54:46.498Z] Jan 09, 2024 8:54:46 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:46 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:54:46.504Z] Jan 09, 2024 8:54:46 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:46 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:54:56.535Z] Jan 09, 2024 8:54:56 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:56 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:54:56.540Z] Jan 09, 2024 8:54:56 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:54:56 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:55:06.561Z] Jan 09, 2024 8:55:06 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:06 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:55:06.562Z] Jan 09, 2024 8:55:06 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:06 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:55:16.586Z] Jan 09, 2024 8:55:16 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:16 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:55:16.592Z] Jan 09, 2024 8:55:16 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:16 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:55:26.623Z] Jan 09, 2024 8:55:26 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:26 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:55:26.626Z] Jan 09, 2024 8:55:26 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:26 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:55:36.658Z] Jan 09, 2024 8:55:36 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:36 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:55:36.663Z] Jan 09, 2024 8:55:36 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:36 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:55:46.690Z] Jan 09, 2024 8:55:46 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:46 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:55:46.694Z] Jan 09, 2024 8:55:46 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:46 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:55:56.727Z] Jan 09, 2024 8:55:56 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:56 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:55:56.735Z] Jan 09, 2024 8:55:56 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:55:56 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:56:01.758Z] Jan 09, 2024 8:56:01 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:01 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:56:01.770Z] Jan 09, 2024 8:56:01 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:01 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:56:04.780Z] Jan 09, 2024 8:56:04 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:04 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:56:04.787Z] Jan 09, 2024 8:56:04 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:04 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:56:11.462Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast [none]
[debug] [2024-01-09T20:56:11.462Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"eventId":"31a95a54-1b91-456e-b500-28dadc4509bb","eventType":"providers/firebase.auth/eventTypes/user.delete","resource":{"name":"projects/ptate-df901","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-01-09T20:56:11.460Z","data":{"uid":"jeHnqPiE2DQw7vwwTnQ1PgE54SE8","email":"maberwilliam@gmail.com","emailVerified":false,"metadata":{"creationTime":"2024-01-09T20:52:58.080Z","lastSignInTime":"2024-01-09T20:52:58.103Z"},"customClaims":{},"providerData":[{"providerId":"password","email":"maberwilliam@gmail.com","federatedId":"maberwilliam@gmail.com","rawId":"maberwilliam@gmail.com"}]}}
[debug] [2024-01-09T20:56:11.474Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast 200
[debug] [2024-01-09T20:56:11.475Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-01-09T20:56:13.815Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast [none]
[debug] [2024-01-09T20:56:13.815Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"eventId":"9517c49b-906c-487a-a024-fd1a9e71f65f","eventType":"providers/firebase.auth/eventTypes/user.create","resource":{"name":"projects/ptate-df901","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-01-09T20:56:13.814Z","data":{"uid":"8Uq6NEJxdiiy4YduAze2rQ3FLMKr","email":"maberwilliam@gmail.com","emailVerified":false,"metadata":{"creationTime":"2024-01-09T20:56:13.810Z","lastSignInTime":"2024-01-09T20:56:13.810Z"},"customClaims":{},"providerData":[{"providerId":"password","email":"maberwilliam@gmail.com","federatedId":"maberwilliam@gmail.com","rawId":"maberwilliam@gmail.com"}]}}
[debug] [2024-01-09T20:56:13.844Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast 200
[debug] [2024-01-09T20:56:13.844Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-01-09T20:56:13.871Z] Jan 09, 2024 8:56:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:56:13.889Z] Jan 09, 2024 8:56:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:56:13.899Z] Jan 09, 2024 8:56:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:56:13.906Z] Jan 09, 2024 8:56:13 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:1045)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:955)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:942)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.write(CloudFirestoreV1.java:930)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:210)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:138)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:93)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:26)
	at com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:160)
	at com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:130)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.onMessage(ChannelInternalImpl.java:525)
	at com.google.net.webchannel.server.v8.ForwardChannel.deliverMessage(ForwardChannel.java:114)
	at com.google.net.webchannel.server.v8.ForwardChannel.processPendingRequest(ForwardChannel.java:93)
	at com.google.net.webchannel.server.v8.ForwardChannel.consume(ForwardChannel.java:67)
	at com.google.net.webchannel.server.v8.ForwardChannel.add(ForwardChannel.java:60)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.handleRequestBody(ChannelInternalImpl.java:290)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.processSessionRequest(ChannelInternalImpl.java:357)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.handle(ChannelInternalImpl.java:172)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.consume(ChannelInternalImpl.java:91)
	at com.google.net.webchannel.server.common.ChannelProcessor.run(ChannelProcessor.java:86)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 22 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:13 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:1045)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:955)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:942)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.write(CloudFirestoreV1.java:930)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:210)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:138)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:93)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:26)\n\tat com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:160)\n\tat com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:130)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.onMessage(ChannelInternalImpl.java:525)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.deliverMessage(ForwardChannel.java:114)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.processPendingRequest(ForwardChannel.java:93)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.consume(ForwardChannel.java:67)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.add(ForwardChannel.java:60)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.handleRequestBody(ChannelInternalImpl.java:290)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.processSessionRequest(ChannelInternalImpl.java:357)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.handle(ChannelInternalImpl.java:172)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.consume(ChannelInternalImpl.java:91)\n\tat com.google.net.webchannel.server.common.ChannelProcessor.run(ChannelProcessor.java:86)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 22 more\n\n"}}
[debug] [2024-01-09T20:56:13.914Z] Jan 09, 2024 8:56:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:56:13.917Z] Jan 09, 2024 8:56:13 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose
INFO: channel closed
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:13 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose\nINFO: channel closed\n"}}
[debug] [2024-01-09T20:56:18.169Z] Jan 09, 2024 8:56:18 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler channelClosed
INFO: Websocket client disconnected
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:18 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler channelClosed\nINFO: Websocket client disconnected\n"}}
[debug] [2024-01-09T20:56:18.367Z] Jan 09, 2024 8:56:18 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler initChannel
INFO: Connected to new websocket client
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:18 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler initChannel\nINFO: Connected to new websocket client\n"}}
[debug] [2024-01-09T20:56:19.122Z] Jan 09, 2024 8:56:19 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler channelClosed
INFO: Websocket client disconnected
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:19 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler channelClosed\nINFO: Websocket client disconnected\n"}}
[debug] [2024-01-09T20:56:19.265Z] Jan 09, 2024 8:56:19 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler initChannel
INFO: Connected to new websocket client
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:19 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler initChannel\nINFO: Connected to new websocket client\n"}}
[debug] [2024-01-09T20:56:20.541Z] Jan 09, 2024 8:56:20 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:20 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:56:20.548Z] Jan 09, 2024 8:56:20 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:20 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:56:30.571Z] Jan 09, 2024 8:56:30 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:30 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:56:30.575Z] Jan 09, 2024 8:56:30 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:56:30 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:58:21.312Z] Jan 09, 2024 8:58:21 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:21 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:58:21.315Z] Jan 09, 2024 8:58:21 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:21 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:58:26.816Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast [none]
[debug] [2024-01-09T20:58:26.816Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"eventId":"fbb4e32a-188c-4422-bcb6-a36e6f321948","eventType":"providers/firebase.auth/eventTypes/user.delete","resource":{"name":"projects/ptate-df901","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-01-09T20:58:26.815Z","data":{"uid":"8Uq6NEJxdiiy4YduAze2rQ3FLMKr","email":"maberwilliam@gmail.com","emailVerified":false,"metadata":{"creationTime":"2024-01-09T20:56:13.810Z","lastSignInTime":"2024-01-09T20:56:13.857Z"},"customClaims":{},"providerData":[{"providerId":"password","email":"maberwilliam@gmail.com","federatedId":"maberwilliam@gmail.com","rawId":"maberwilliam@gmail.com"}]}}
[debug] [2024-01-09T20:58:26.826Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast 200
[debug] [2024-01-09T20:58:26.827Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-01-09T20:58:29.434Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast [none]
[debug] [2024-01-09T20:58:29.435Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"eventId":"2bf29a4d-71e0-4a04-b0c9-6148e9d402dd","eventType":"providers/firebase.auth/eventTypes/user.create","resource":{"name":"projects/ptate-df901","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-01-09T20:58:29.433Z","data":{"uid":"CcOEktHYSwS1AwmaStHh0LZwf9kF","email":"maberwilliam@gmail.com","emailVerified":false,"metadata":{"creationTime":"2024-01-09T20:58:29.432Z","lastSignInTime":"2024-01-09T20:58:29.432Z"},"customClaims":{},"providerData":[{"providerId":"password","email":"maberwilliam@gmail.com","federatedId":"maberwilliam@gmail.com","rawId":"maberwilliam@gmail.com"}]}}
[debug] [2024-01-09T20:58:29.460Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast 200
[debug] [2024-01-09T20:58:29.460Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-01-09T20:58:29.525Z] Jan 09, 2024 8:58:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:58:29.535Z] Jan 09, 2024 8:58:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:58:29.546Z] Jan 09, 2024 8:58:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:58:29.553Z] Jan 09, 2024 8:58:29 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:1045)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:955)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:942)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.write(CloudFirestoreV1.java:930)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:210)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:138)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:93)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:26)
	at com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:160)
	at com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:130)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.onMessage(ChannelInternalImpl.java:525)
	at com.google.net.webchannel.server.v8.ForwardChannel.deliverMessage(ForwardChannel.java:114)
	at com.google.net.webchannel.server.v8.ForwardChannel.processPendingRequest(ForwardChannel.java:93)
	at com.google.net.webchannel.server.v8.ForwardChannel.consume(ForwardChannel.java:67)
	at com.google.net.webchannel.server.v8.ForwardChannel.add(ForwardChannel.java:60)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.handleRequestBody(ChannelInternalImpl.java:290)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.processSessionRequest(ChannelInternalImpl.java:357)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.handle(ChannelInternalImpl.java:172)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.consume(ChannelInternalImpl.java:91)
	at com.google.net.webchannel.server.common.ChannelProcessor.run(ChannelProcessor.java:86)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 22 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:29 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:1045)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:955)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:942)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.write(CloudFirestoreV1.java:930)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:210)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:138)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:93)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:26)\n\tat com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:160)\n\tat com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:130)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.onMessage(ChannelInternalImpl.java:525)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.deliverMessage(ForwardChannel.java:114)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.processPendingRequest(ForwardChannel.java:93)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.consume(ForwardChannel.java:67)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.add(ForwardChannel.java:60)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.handleRequestBody(ChannelInternalImpl.java:290)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.processSessionRequest(ChannelInternalImpl.java:357)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.handle(ChannelInternalImpl.java:172)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.consume(ChannelInternalImpl.java:91)\n\tat com.google.net.webchannel.server.common.ChannelProcessor.run(ChannelProcessor.java:86)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 22 more\n\n"}}
[debug] [2024-01-09T20:58:29.561Z] Jan 09, 2024 8:58:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:58:29.567Z] Jan 09, 2024 8:58:29 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose
INFO: channel closed
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:29 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose\nINFO: channel closed\n"}}
[debug] [2024-01-09T20:58:38.039Z] Jan 09, 2024 8:58:38 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:38 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:58:38.043Z] Jan 09, 2024 8:58:38 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:38 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:58:48.014Z] Jan 09, 2024 8:58:48 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:48 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:58:48.016Z] Jan 09, 2024 8:58:48 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:48 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:58:58.029Z] Jan 09, 2024 8:58:58 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:58 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:58:58.030Z] Jan 09, 2024 8:58:58 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:58:58 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:59:08.059Z] Jan 09, 2024 8:59:08 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:08 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:59:08.065Z] Jan 09, 2024 8:59:08 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:08 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:59:18.095Z] Jan 09, 2024 8:59:18 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:18 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:59:18.097Z] Jan 09, 2024 8:59:18 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:18 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[debug] [2024-01-09T20:59:28.129Z] Jan 09, 2024 8:59:28 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:28 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:59:28.144Z] Jan 09, 2024 8:59:28 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L112:50 Unexpected '='.
L112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L117:50 Unexpected '='.
L118:18 Missing 'match' keyword before path.
L118:28 Forward slash '/' found where identifier or binding expected.
L118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:40 Missing 'match' keyword before path.
L118:59 Forward slash '/' found where identifier or binding expected.
L118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L118:73 Missing 'match' keyword before path.
L118:83 Forward slash '/' found where identifier or binding expected.
L118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L119:8 Unexpected ')'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:28 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL112:50 Unexpected '='.\nL112:67 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL117:50 Unexpected '='.\nL118:18 Missing 'match' keyword before path.\nL118:28 Forward slash '/' found where identifier or binding expected.\nL118:29 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:40 Missing 'match' keyword before path.\nL118:59 Forward slash '/' found where identifier or binding expected.\nL118:60 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL118:73 Missing 'match' keyword before path.\nL118:83 Forward slash '/' found where identifier or binding expected.\nL118:84 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL119:8 Unexpected ')'.\n"}}
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T20:59:29.868Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T20:59:29.868Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      return get(/databases/$(database)/documents/user/$(request.auth.uid)).data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /election {\n      allow list: if request.auth != null;\n    }\n\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list && data.candidateId.size() > 0 && data.candidateId.size() < 100 &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, request.resource.data.electionId) &&\n        request.auth.uid == data.uid;  // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        return value is list && value.every((item) => item is string);\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n        });\n    }\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T20:59:29.871Z] Jan 09, 2024 8:59:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T20:59:29.980Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T20:59:29.981Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":116,"column":52,"currentOffset":4027,"endOffset":4027},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":116,"column":69,"currentOffset":4044,"endOffset":4044},"description":"mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":52,"currentOffset":4283,"endOffset":4283},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":20,"currentOffset":4307,"endOffset":4316},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":30,"currentOffset":4317,"endOffset":4317},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":31,"currentOffset":4318,"endOffset":4318},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":42,"currentOffset":4329,"endOffset":4338},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":61,"currentOffset":4348,"endOffset":4348},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":62,"currentOffset":4349,"endOffset":4349},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":75,"currentOffset":4362,"endOffset":4371},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":85,"currentOffset":4372,"endOffset":4372},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":86,"currentOffset":4373,"endOffset":4373},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":10,"currentOffset":4412,"endOffset":4412},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4425,"endOffset":4429},"description":"Unexpected 'allow'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:116:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:116:69 - ERROR mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'} 
[warn] ⚠  firestore.rules:121:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:122:20 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:30 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:31 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:42 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:61 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:62 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:75 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:85 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:86 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[info] ✔  firestore: Rules updated. 
[debug] [2024-01-09T20:59:38.165Z] Jan 09, 2024 8:59:38 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:38 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:59:38.173Z] Jan 09, 2024 8:59:38 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:38 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n"}}
[debug] [2024-01-09T20:59:48.186Z] Jan 09, 2024 8:59:48 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:48 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:59:48.187Z] Jan 09, 2024 8:59:48 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:48 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n"}}
[debug] [2024-01-09T20:59:58.197Z] Jan 09, 2024 8:59:58 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:58 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T20:59:58.199Z] Jan 09, 2024 8:59:58 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 8:59:58 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n"}}
[debug] [2024-01-09T21:00:08.222Z] Jan 09, 2024 9:00:08 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:08 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T21:00:08.226Z] Jan 09, 2024 9:00:08 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:08 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n"}}
[debug] [2024-01-09T21:00:12.317Z] Jan 09, 2024 9:00:12 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)
	at com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)
	at com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 24 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:12 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.listCollectionIds(CloudFirestoreV1.java:642)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1Router.listCollectionIds(CloudFirestoreV1Router.java:212)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.lambda$listCollectionIds$12(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter.unary(FirestoreV1GrpcAdapter.java:70)\n\tat com.google.cloud.datastore.emulator.firestore.v1.FirestoreV1GrpcAdapter$1.listCollectionIds(FirestoreV1GrpcAdapter.java:201)\n\tat com.google.firestore.v1.FirestoreGrpc$MethodHandlers.invoke(FirestoreGrpc.java:1199)\n\tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:346)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:860)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 24 more\n\n"}}
[debug] [2024-01-09T21:00:12.321Z] Jan 09, 2024 9:00:12 PM io.gapi.emulators.netty.HttpHandler$1 onError
INFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:12 PM io.gapi.emulators.netty.HttpHandler$1 onError\nINFO: Exception when handling request: INVALID_ARGUMENT: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n"}}
[debug] [2024-01-09T21:00:18.476Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast [none]
[debug] [2024-01-09T21:00:18.477Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"eventId":"219a6d8b-624c-4ba5-9bb4-13fdcf13ccbf","eventType":"providers/firebase.auth/eventTypes/user.delete","resource":{"name":"projects/ptate-df901","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-01-09T21:00:18.475Z","data":{"uid":"CcOEktHYSwS1AwmaStHh0LZwf9kF","email":"maberwilliam@gmail.com","emailVerified":false,"metadata":{"creationTime":"2024-01-09T20:58:29.432Z","lastSignInTime":"2024-01-09T20:58:29.508Z"},"customClaims":{},"providerData":[{"providerId":"password","email":"maberwilliam@gmail.com","federatedId":"maberwilliam@gmail.com","rawId":"maberwilliam@gmail.com"}]}}
[debug] [2024-01-09T21:00:18.485Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast 200
[debug] [2024-01-09T21:00:18.485Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-01-09T21:00:31.245Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast [none]
[debug] [2024-01-09T21:00:31.246Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"eventId":"60370704-992f-40b5-818f-5c70bd7be9d3","eventType":"providers/firebase.auth/eventTypes/user.create","resource":{"name":"projects/ptate-df901","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-01-09T21:00:31.244Z","data":{"uid":"HYYK66ipwhy2XUTiLvzHxu5JTItc","email":"maberwilliam@gmail.com","emailVerified":false,"metadata":{"creationTime":"2024-01-09T21:00:31.244Z","lastSignInTime":"2024-01-09T21:00:31.244Z"},"customClaims":{},"providerData":[{"providerId":"password","email":"maberwilliam@gmail.com","federatedId":"maberwilliam@gmail.com","rawId":"maberwilliam@gmail.com"}]}}
[debug] [2024-01-09T21:00:31.258Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast 200
[debug] [2024-01-09T21:00:31.259Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/ptate-df901/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-01-09T21:00:31.341Z] Jan 09, 2024 9:00:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:00:31.352Z] Jan 09, 2024 9:00:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:00:31.361Z] Jan 09, 2024 9:00:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:00:31.366Z] Jan 09, 2024 9:00:31 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError
WARNING: Operation failed: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
com.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:
L116:52 Unexpected '='.
L116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}
L121:52 Unexpected '='.
L122:20 Missing 'match' keyword before path.
L122:30 Forward slash '/' found where identifier or binding expected.
L122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:42 Missing 'match' keyword before path.
L122:61 Forward slash '/' found where identifier or binding expected.
L122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L122:75 Missing 'match' keyword before path.
L122:85 Forward slash '/' found where identifier or binding expected.
L122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}
L123:10 Unexpected ')'.
L125:5 Unexpected 'allow'.
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:1045)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:955)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:942)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.write(CloudFirestoreV1.java:930)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:210)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:138)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:93)
	at com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:26)
	at com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:160)
	at com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:130)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.onMessage(ChannelInternalImpl.java:525)
	at com.google.net.webchannel.server.v8.ForwardChannel.deliverMessage(ForwardChannel.java:114)
	at com.google.net.webchannel.server.v8.ForwardChannel.processPendingRequest(ForwardChannel.java:93)
	at com.google.net.webchannel.server.v8.ForwardChannel.consume(ForwardChannel.java:67)
	at com.google.net.webchannel.server.v8.ForwardChannel.add(ForwardChannel.java:60)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.handleRequestBody(ChannelInternalImpl.java:290)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.processSessionRequest(ChannelInternalImpl.java:357)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.handle(ChannelInternalImpl.java:172)
	at com.google.net.webchannel.server.v8.ChannelInternalImpl.consume(ChannelInternalImpl.java:91)
	at com.google.net.webchannel.server.common.ChannelProcessor.run(ChannelProcessor.java:86)
Caused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException
	at com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)
	... 22 more

 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:31 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nWARNING: Operation failed: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\ncom.google.cloud.datastore.core.exception.DatastoreException: Error compiling rules:\nL116:52 Unexpected '='.\nL116:69 mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}\nL121:52 Unexpected '='.\nL122:20 Missing 'match' keyword before path.\nL122:30 Forward slash '/' found where identifier or binding expected.\nL122:31 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:42 Missing 'match' keyword before path.\nL122:61 Forward slash '/' found where identifier or binding expected.\nL122:62 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL122:75 Missing 'match' keyword before path.\nL122:85 Forward slash '/' found where identifier or binding expected.\nL122:86 mismatched input '$' expecting {'{', '/', PATH_SEGMENT}\nL123:10 Unexpected ')'.\nL125:5 Unexpected 'allow'.\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.asDatastoreException(EmulatorRulesCompiler.java:115)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.checkCompilationSucceeded(EmulatorRulesCompiler.java:74)\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$EmulatorCompilationResult.getAuthorizer(EmulatorRulesCompiler.java:67)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:1045)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:955)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:942)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1.write(CloudFirestoreV1.java:930)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:210)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:138)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:93)\n\tat com.google.cloud.datastore.emulator.impl.firestore.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:26)\n\tat com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:160)\n\tat com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler.onMessage(FirestoreV1WebChannelAdapter.java:130)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.onMessage(ChannelInternalImpl.java:525)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.deliverMessage(ForwardChannel.java:114)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.processPendingRequest(ForwardChannel.java:93)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.consume(ForwardChannel.java:67)\n\tat com.google.net.webchannel.server.v8.ForwardChannel.add(ForwardChannel.java:60)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.handleRequestBody(ChannelInternalImpl.java:290)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.processSessionRequest(ChannelInternalImpl.java:357)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.handle(ChannelInternalImpl.java:172)\n\tat com.google.net.webchannel.server.v8.ChannelInternalImpl.consume(ChannelInternalImpl.java:91)\n\tat com.google.net.webchannel.server.common.ChannelProcessor.run(ChannelProcessor.java:86)\nCaused by: com.google.cloud.datastore.emulator.impl.rules.AutoValue_EmulatorRulesCompiler_CompilerException\n\tat com.google.cloud.datastore.emulator.impl.rules.EmulatorRulesCompiler$CompilerException.of(EmulatorRulesCompiler.java:101)\n\t... 22 more\n\n"}}
[debug] [2024-01-09T21:00:31.371Z] Jan 09, 2024 9:00:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:00:31.378Z] Jan 09, 2024 9:00:31 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose
INFO: channel closed
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:00:31 PM com.google.cloud.datastore.emulator.firestore.webchannel.FirestoreV1WebChannelAdapter$FirestoreWriteHandler onClose\nINFO: channel closed\n"}}
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:01:32.124Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:01:32.125Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      return get(/databases/$(database)/documents/user/$(request.auth.uid)).data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /election {\n      allow list: if request.auth != null;\n    }\n\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list && data.candidateId.size() > 0 && data.candidateId.size() < 100 &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, request.resource.data.electionId) &&\n        request.auth.uid == data.uid;  // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return value is list && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n        });\n    }\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:01:32.136Z] Jan 09, 2024 9:01:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:01:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:01:32.249Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:01:32.249Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":122,"column":52,"currentOffset":4307,"endOffset":4307},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":20,"currentOffset":4331,"endOffset":4340},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":30,"currentOffset":4341,"endOffset":4341},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":31,"currentOffset":4342,"endOffset":4342},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":42,"currentOffset":4353,"endOffset":4362},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":61,"currentOffset":4372,"endOffset":4372},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":62,"currentOffset":4373,"endOffset":4373},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":75,"currentOffset":4386,"endOffset":4395},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":85,"currentOffset":4396,"endOffset":4396},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":86,"currentOffset":4397,"endOffset":4397},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":124,"column":10,"currentOffset":4436,"endOffset":4436},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":126,"column":5,"currentOffset":4449,"endOffset":4453},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":130,"column":1,"currentOffset":4619,"endOffset":4619},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:122:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:123:20 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:123:30 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:123:31 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:42 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:123:61 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:123:62 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:75 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:123:85 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:123:86 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:124:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:126:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:130:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:02:55.287Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:02:55.287Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      return get(/databases/$(database)/documents/user/$(request.auth.uid)).data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list && data.candidateId.size() > 0 && data.candidateId.size() < 100 &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, request.resource.data.electionId) &&\n        request.auth.uid == data.uid;  // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return value is list && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n        });\n    }\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:02:55.289Z] Jan 09, 2024 9:02:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:02:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:02:55.356Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:02:55.356Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":121,"column":52,"currentOffset":4307,"endOffset":4307},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":20,"currentOffset":4331,"endOffset":4340},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":30,"currentOffset":4341,"endOffset":4341},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":31,"currentOffset":4342,"endOffset":4342},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":42,"currentOffset":4353,"endOffset":4362},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":61,"currentOffset":4372,"endOffset":4372},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":62,"currentOffset":4373,"endOffset":4373},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":75,"currentOffset":4386,"endOffset":4395},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":85,"currentOffset":4396,"endOffset":4396},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":86,"currentOffset":4397,"endOffset":4397},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":10,"currentOffset":4436,"endOffset":4436},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4449,"endOffset":4453},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4619,"endOffset":4619},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:121:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:122:20 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:30 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:31 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:42 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:61 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:62 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:75 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:85 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:86 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:03:37.769Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:03:37.769Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      return get(/databases/$(database)/documents/user/$(request.auth.uid)).data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return value is list && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n        });\n    }\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:03:37.775Z] Jan 09, 2024 9:03:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:03:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:03:37.914Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:03:37.914Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":121,"column":52,"currentOffset":4218,"endOffset":4218},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":20,"currentOffset":4242,"endOffset":4251},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":30,"currentOffset":4252,"endOffset":4252},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":31,"currentOffset":4253,"endOffset":4253},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":42,"currentOffset":4264,"endOffset":4273},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":61,"currentOffset":4283,"endOffset":4283},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":62,"currentOffset":4284,"endOffset":4284},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":75,"currentOffset":4297,"endOffset":4306},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":85,"currentOffset":4307,"endOffset":4307},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":86,"currentOffset":4308,"endOffset":4308},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":10,"currentOffset":4347,"endOffset":4347},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4360,"endOffset":4364},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4530,"endOffset":4530},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:121:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:122:20 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:30 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:31 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:42 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:61 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:62 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:75 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:85 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:86 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:04:03.431Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:04:03.432Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      return get(/databases/$(database)/documents/user/$(request.auth.uid)).data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return value is list && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n    function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n      return candidateIdList.every((candidateId) => {\n        return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n      });\n    }\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:04:03.440Z] Jan 09, 2024 9:04:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:04:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:04:03.558Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:04:03.558Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":121,"column":50,"currentOffset":4214,"endOffset":4214},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":20,"currentOffset":4238,"endOffset":4247},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":30,"currentOffset":4248,"endOffset":4248},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":31,"currentOffset":4249,"endOffset":4249},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":42,"currentOffset":4260,"endOffset":4269},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":61,"currentOffset":4279,"endOffset":4279},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":62,"currentOffset":4280,"endOffset":4280},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":75,"currentOffset":4293,"endOffset":4302},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":85,"currentOffset":4303,"endOffset":4303},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":86,"currentOffset":4304,"endOffset":4304},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":8,"currentOffset":4341,"endOffset":4341},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":126,"column":5,"currentOffset":4355,"endOffset":4359},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":130,"column":1,"currentOffset":4525,"endOffset":4525},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:121:50 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:122:20 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:30 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:31 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:42 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:61 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:62 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:75 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:85 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:86 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:8 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:126:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:130:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:04:24.196Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:04:24.196Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n  function isAdmin() {\n    let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n    return userDoc != null && userDoc.data.role == 'admin';\n  }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return value is list && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n    function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n      return candidateIdList.every((candidateId) => {\n        return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n      });\n    }\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:04:24.201Z] Jan 09, 2024 9:04:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:04:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:04:24.343Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:04:24.343Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":122,"column":50,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":20,"currentOffset":4278,"endOffset":4287},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":30,"currentOffset":4288,"endOffset":4288},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":31,"currentOffset":4289,"endOffset":4289},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":42,"currentOffset":4300,"endOffset":4309},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":61,"currentOffset":4319,"endOffset":4319},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":62,"currentOffset":4320,"endOffset":4320},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":75,"currentOffset":4333,"endOffset":4342},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":85,"currentOffset":4343,"endOffset":4343},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":86,"currentOffset":4344,"endOffset":4344},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":124,"column":8,"currentOffset":4381,"endOffset":4381},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":127,"column":5,"currentOffset":4395,"endOffset":4399},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":131,"column":1,"currentOffset":4565,"endOffset":4565},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:122:50 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:123:20 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:123:30 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:123:31 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:42 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:123:61 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:123:62 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:75 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:123:85 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:123:86 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:124:8 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:127:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:131:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:05:27.370Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:05:27.370Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return value is list && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n        });\n    }\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:05:27.382Z] Jan 09, 2024 9:05:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:05:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:05:27.425Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:05:27.425Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":122,"column":52,"currentOffset":4266,"endOffset":4266},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":20,"currentOffset":4290,"endOffset":4299},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":30,"currentOffset":4300,"endOffset":4300},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":31,"currentOffset":4301,"endOffset":4301},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":42,"currentOffset":4312,"endOffset":4321},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":61,"currentOffset":4331,"endOffset":4331},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":62,"currentOffset":4332,"endOffset":4332},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":75,"currentOffset":4345,"endOffset":4354},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":85,"currentOffset":4355,"endOffset":4355},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":86,"currentOffset":4356,"endOffset":4356},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":124,"column":10,"currentOffset":4395,"endOffset":4395},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":127,"column":5,"currentOffset":4409,"endOffset":4413},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":131,"column":1,"currentOffset":4579,"endOffset":4579},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:122:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:123:20 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:123:30 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:123:31 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:42 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:123:61 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:123:62 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:75 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:123:85 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:123:86 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:124:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:127:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:131:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:06:30.129Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:06:30.130Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return value is list && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n        });\n    }\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n"}]}}
[debug] [2024-01-09T21:06:30.138Z] Jan 09, 2024 9:06:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:06:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:06:30.185Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:06:30.185Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":52,"currentOffset":4264,"endOffset":4264},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":20,"currentOffset":4288,"endOffset":4297},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4298,"endOffset":4298},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":31,"currentOffset":4299,"endOffset":4299},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":42,"currentOffset":4310,"endOffset":4319},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4329,"endOffset":4329},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":62,"currentOffset":4330,"endOffset":4330},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":75,"currentOffset":4343,"endOffset":4352},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4353,"endOffset":4353},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":86,"currentOffset":4354,"endOffset":4354},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":10,"currentOffset":4393,"endOffset":4393},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4407,"endOffset":4411},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4577,"endOffset":4577},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:20 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:30 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:31 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:42 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:61 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:62 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:75 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:85 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:86 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:07:26.298Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:07:26.298Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n  \n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          // return value is list && value.every((item) => item is string);\n          return true;\n        }\n  \n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          return candidateIdList.every((candidateId) => {\n          return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          });\n      }\n  \n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:07:26.299Z] Jan 09, 2024 9:07:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:07:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:07:26.335Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:07:26.336Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":54,"currentOffset":4300,"endOffset":4300},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":22,"currentOffset":4326,"endOffset":4335},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":32,"currentOffset":4336,"endOffset":4336},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4337,"endOffset":4337},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":44,"currentOffset":4348,"endOffset":4357},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":63,"currentOffset":4367,"endOffset":4367},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4368,"endOffset":4368},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":77,"currentOffset":4381,"endOffset":4390},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":87,"currentOffset":4391,"endOffset":4391},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4392,"endOffset":4392},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":12,"currentOffset":4433,"endOffset":4433},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":7,"currentOffset":4453,"endOffset":4457},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":3,"currentOffset":4631,"endOffset":4631},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:22 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:32 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:33 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:44 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:63 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:64 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:77 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:87 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:88 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:12 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:7 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:3 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:07:32.872Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:07:32.872Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n        \n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          // return value is list && value.every((item) => item is string);\n          return true;\n        }\n\n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          return candidateIdList.every((candidateId) => {\n          return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          });\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:07:32.876Z] Jan 09, 2024 9:07:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:07:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:07:32.999Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:07:32.999Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":54,"currentOffset":4304,"endOffset":4304},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":22,"currentOffset":4330,"endOffset":4339},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":32,"currentOffset":4340,"endOffset":4340},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4341,"endOffset":4341},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":44,"currentOffset":4352,"endOffset":4361},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":63,"currentOffset":4371,"endOffset":4371},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4372,"endOffset":4372},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":77,"currentOffset":4385,"endOffset":4394},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":87,"currentOffset":4395,"endOffset":4395},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4396,"endOffset":4396},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":12,"currentOffset":4437,"endOffset":4437},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":7,"currentOffset":4455,"endOffset":4459},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":3,"currentOffset":4633,"endOffset":4633},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:22 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:32 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:33 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:44 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:63 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:64 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:77 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:87 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:88 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:12 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:7 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:3 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:07:40.405Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:07:40.405Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n        \n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          // return value is list && value.every((item) => item is string);\n          return true;\n        }\n\n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          return candidateIdList.every((candidateId) => {\n          return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          });\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:07:40.411Z] Jan 09, 2024 9:07:40 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:07:40 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:07:40.517Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:07:40.517Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":54,"currentOffset":4304,"endOffset":4304},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":22,"currentOffset":4330,"endOffset":4339},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":32,"currentOffset":4340,"endOffset":4340},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4341,"endOffset":4341},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":44,"currentOffset":4352,"endOffset":4361},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":63,"currentOffset":4371,"endOffset":4371},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4372,"endOffset":4372},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":77,"currentOffset":4385,"endOffset":4394},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":87,"currentOffset":4395,"endOffset":4395},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4396,"endOffset":4396},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":12,"currentOffset":4437,"endOffset":4437},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":7,"currentOffset":4455,"endOffset":4459},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":3,"currentOffset":4633,"endOffset":4633},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:22 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:32 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:33 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:44 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:63 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:64 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:77 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:87 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:88 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:12 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:7 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:3 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:08:10.019Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:08:10.020Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n\n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          return value is list && value.every((item) => item is string);\n          // return true;\n        }\n\n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          return candidateIdList.every((candidateId) => {\n          return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          });\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:08:10.024Z] Jan 09, 2024 9:08:10 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:08:10 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:08:10.139Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:08:10.139Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":114,"column":54,"currentOffset":4006,"endOffset":4006},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":114,"column":71,"currentOffset":4023,"endOffset":4023},"description":"mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":54,"currentOffset":4296,"endOffset":4296},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":22,"currentOffset":4322,"endOffset":4331},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":32,"currentOffset":4332,"endOffset":4332},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4333,"endOffset":4333},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":44,"currentOffset":4344,"endOffset":4353},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":63,"currentOffset":4363,"endOffset":4363},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4364,"endOffset":4364},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":77,"currentOffset":4377,"endOffset":4386},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":87,"currentOffset":4387,"endOffset":4387},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4388,"endOffset":4388},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":12,"currentOffset":4429,"endOffset":4429},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":7,"currentOffset":4447,"endOffset":4451},"description":"Unexpected 'allow'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:114:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:114:71 - ERROR mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'} 
[warn] ⚠  firestore.rules:120:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:22 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:32 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:33 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:44 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:63 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:64 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:77 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:87 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:88 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:12 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:7 - ERROR Unexpected 'allow'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:08:33.560Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:08:33.560Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n\n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          return (value is list) && value.every((item) => item is string);\n          // return true;\n        }\n\n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          return candidateIdList.every((candidateId) => {\n          return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          });\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:08:33.562Z] Jan 09, 2024 9:08:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:08:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:08:33.593Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:08:33.593Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":114,"column":56,"currentOffset":4008,"endOffset":4008},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":114,"column":73,"currentOffset":4025,"endOffset":4025},"description":"mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":54,"currentOffset":4298,"endOffset":4298},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":22,"currentOffset":4324,"endOffset":4333},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":32,"currentOffset":4334,"endOffset":4334},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4335,"endOffset":4335},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":44,"currentOffset":4346,"endOffset":4355},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":63,"currentOffset":4365,"endOffset":4365},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4366,"endOffset":4366},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":77,"currentOffset":4379,"endOffset":4388},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":87,"currentOffset":4389,"endOffset":4389},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4390,"endOffset":4390},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":12,"currentOffset":4431,"endOffset":4431},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":7,"currentOffset":4449,"endOffset":4453},"description":"Unexpected 'allow'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:114:56 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:114:73 - ERROR mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'} 
[warn] ⚠  firestore.rules:120:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:22 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:32 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:33 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:44 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:63 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:64 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:77 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:87 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:88 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:12 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:7 - ERROR Unexpected 'allow'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:08:49.847Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:08:49.847Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n\n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          return (value is list) && value.every((item) => item is string);\n          // return true;\n        }\n\n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          return candidateIdList.every((candidateId) => {\n          return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          });\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:08:49.854Z] Jan 09, 2024 9:08:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:08:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:08:49.963Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:08:49.963Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":114,"column":56,"currentOffset":4008,"endOffset":4008},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":114,"column":73,"currentOffset":4025,"endOffset":4025},"description":"mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":54,"currentOffset":4298,"endOffset":4298},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":22,"currentOffset":4324,"endOffset":4333},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":32,"currentOffset":4334,"endOffset":4334},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4335,"endOffset":4335},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":44,"currentOffset":4346,"endOffset":4355},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":63,"currentOffset":4365,"endOffset":4365},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4366,"endOffset":4366},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":77,"currentOffset":4379,"endOffset":4388},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":87,"currentOffset":4389,"endOffset":4389},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4390,"endOffset":4390},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":12,"currentOffset":4431,"endOffset":4431},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":7,"currentOffset":4449,"endOffset":4453},"description":"Unexpected 'allow'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:114:56 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:114:73 - ERROR mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'} 
[warn] ⚠  firestore.rules:120:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:22 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:32 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:33 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:44 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:63 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:64 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:77 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:87 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:88 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:12 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:7 - ERROR Unexpected 'allow'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:08:51.986Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:08:51.986Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n\n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          return (value is list) && value.every((item) => item is string);\n          // return true;\n        }\n\n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          return candidateIdList.every((candidateId) => {\n            return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          });\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:08:51.994Z] Jan 09, 2024 9:08:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:08:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:08:52.090Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:08:52.090Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":114,"column":56,"currentOffset":4008,"endOffset":4008},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":114,"column":73,"currentOffset":4025,"endOffset":4025},"description":"mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":54,"currentOffset":4298,"endOffset":4298},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":24,"currentOffset":4326,"endOffset":4335},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":34,"currentOffset":4336,"endOffset":4336},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":35,"currentOffset":4337,"endOffset":4337},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":46,"currentOffset":4348,"endOffset":4357},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":65,"currentOffset":4367,"endOffset":4367},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":66,"currentOffset":4368,"endOffset":4368},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":79,"currentOffset":4381,"endOffset":4390},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":89,"currentOffset":4391,"endOffset":4391},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":90,"currentOffset":4392,"endOffset":4392},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":12,"currentOffset":4433,"endOffset":4433},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":7,"currentOffset":4451,"endOffset":4455},"description":"Unexpected 'allow'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:114:56 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:114:73 - ERROR mismatched input ')' expecting {'&&', '==', '>', '>=', '<', '<=', '-', '%', '!=', '||', '+', '}', ';', '/', '*', '?', 'in', 'is'} 
[warn] ⚠  firestore.rules:120:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:24 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:34 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:35 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:46 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:65 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:66 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:79 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:89 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:90 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:12 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:7 - ERROR Unexpected 'allow'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:09:53.830Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:09:53.830Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n\n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          // return (value is list) && value.every((item) => item is string);\n          // return true;\n        }\n\n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          return candidateIdList.every((candidateId) => {\n            return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          });\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:09:53.833Z] Jan 09, 2024 9:09:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:09:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:09:53.880Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:09:53.880Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":116,"column":9,"currentOffset":4065,"endOffset":4065},"description":"Missing 'function' body","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":54,"currentOffset":4301,"endOffset":4301},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":24,"currentOffset":4329,"endOffset":4338},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":34,"currentOffset":4339,"endOffset":4339},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":35,"currentOffset":4340,"endOffset":4340},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":46,"currentOffset":4351,"endOffset":4360},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":65,"currentOffset":4370,"endOffset":4370},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":66,"currentOffset":4371,"endOffset":4371},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":79,"currentOffset":4384,"endOffset":4393},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":89,"currentOffset":4394,"endOffset":4394},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":90,"currentOffset":4395,"endOffset":4395},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":12,"currentOffset":4436,"endOffset":4436},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":7,"currentOffset":4454,"endOffset":4458},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":3,"currentOffset":4632,"endOffset":4632},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:116:9 - ERROR Missing 'function' body 
[warn] ⚠  firestore.rules:120:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:24 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:34 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:35 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:46 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:65 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:66 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:79 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:89 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:90 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:12 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:7 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:3 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:09:56.129Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:09:56.129Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n\n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          // return (value is list) && value.every((item) => item is string);\n          return true;\n        }\n\n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          return candidateIdList.every((candidateId) => {\n            return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          });\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:09:56.130Z] Jan 09, 2024 9:09:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:09:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:09:56.155Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:09:56.156Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":54,"currentOffset":4298,"endOffset":4298},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":24,"currentOffset":4326,"endOffset":4335},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":34,"currentOffset":4336,"endOffset":4336},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":35,"currentOffset":4337,"endOffset":4337},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":46,"currentOffset":4348,"endOffset":4357},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":65,"currentOffset":4367,"endOffset":4367},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":66,"currentOffset":4368,"endOffset":4368},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":79,"currentOffset":4381,"endOffset":4390},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":89,"currentOffset":4391,"endOffset":4391},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":90,"currentOffset":4392,"endOffset":4392},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":12,"currentOffset":4433,"endOffset":4433},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":7,"currentOffset":4451,"endOffset":4455},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":3,"currentOffset":4629,"endOffset":4629},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:54 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:24 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:34 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:35 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:46 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:65 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:66 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:79 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:89 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:90 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:12 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:7 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:3 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:10:22.796Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:10:22.797Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n        // Function to validate vote data\n        function isValidVoteData(data) {\n          return data.keys().hasAll(['candidateId']) &&\n          data.candidateId is list &&\n          isStringList(data.candidateId) &&\n          allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n          request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n        }\n\n      // Helper function to check if a value is a list of strings\n        function isStringList(value) {\n          // return (value is list) && value.every((item) => item is string);\n          return true;\n        }\n\n      // Helper function to check if all strings in the list exist in the candidate collection\n        function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n          // return candidateIdList.every((candidateId) => {\n          //   return get(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)).data != null;\n          // });\n          return true;\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:10:22.800Z] Jan 09, 2024 9:10:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:10:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:10:23.256Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:10:23.256Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":11,"column":14,"currentOffset":282,"endOffset":300},"description":"Unused function: isValidElectionData.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":113,"column":31,"currentOffset":3944,"endOffset":3948},"description":"Unused variable: value.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":119,"column":55,"currentOffset":4214,"endOffset":4228},"description":"Unused variable: candidateIdList.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":119,"column":72,"currentOffset":4231,"endOffset":4240},"description":"Unused variable: electionId.","severity":"WARNING"}]}
[warn] ⚠  firestore.rules:11:14 - WARNING Unused function: isValidElectionData. 
[warn] ⚠  firestore.rules:113:31 - WARNING Unused variable: value. 
[warn] ⚠  firestore.rules:119:55 - WARNING Unused variable: candidateIdList. 
[warn] ⚠  firestore.rules:119:72 - WARNING Unused variable: electionId. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:11:32.785Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:11:32.786Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n        });\n    }\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:11:32.790Z] Jan 09, 2024 9:11:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:11:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:11:32.889Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:11:32.889Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":52,"currentOffset":4266,"endOffset":4266},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":23,"currentOffset":4293,"endOffset":4302},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4303,"endOffset":4303},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":34,"currentOffset":4304,"endOffset":4304},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":45,"currentOffset":4315,"endOffset":4324},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4334,"endOffset":4334},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":65,"currentOffset":4335,"endOffset":4335},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":78,"currentOffset":4348,"endOffset":4357},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4358,"endOffset":4358},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":89,"currentOffset":4359,"endOffset":4359},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":10,"currentOffset":4385,"endOffset":4385},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4399,"endOffset":4403},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4569,"endOffset":4569},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:23 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:33 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:34 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:45 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:64 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:65 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:78 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:88 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:89 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:11:37.565Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:11:37.565Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n    function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n        });\n    }\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:11:37.598Z] Jan 09, 2024 9:11:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:11:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:11:37.666Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:11:37.666Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":52,"currentOffset":4264,"endOffset":4264},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":23,"currentOffset":4291,"endOffset":4300},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4301,"endOffset":4301},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":34,"currentOffset":4302,"endOffset":4302},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":45,"currentOffset":4313,"endOffset":4322},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4332,"endOffset":4332},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":65,"currentOffset":4333,"endOffset":4333},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":78,"currentOffset":4346,"endOffset":4355},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4356,"endOffset":4356},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":89,"currentOffset":4357,"endOffset":4357},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":10,"currentOffset":4383,"endOffset":4383},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4397,"endOffset":4401},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4567,"endOffset":4567},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:23 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:33 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:34 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:45 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:64 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:65 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:78 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:88 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:89 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:11:38.532Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:11:38.532Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n    function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n        });\n    }\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:11:38.537Z] Jan 09, 2024 9:11:38 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:11:38 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:11:38.622Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:11:38.622Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":52,"currentOffset":4264,"endOffset":4264},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":23,"currentOffset":4291,"endOffset":4300},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4301,"endOffset":4301},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":34,"currentOffset":4302,"endOffset":4302},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":45,"currentOffset":4313,"endOffset":4322},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4332,"endOffset":4332},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":65,"currentOffset":4333,"endOffset":4333},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":78,"currentOffset":4346,"endOffset":4355},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4356,"endOffset":4356},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":89,"currentOffset":4357,"endOffset":4357},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":10,"currentOffset":4383,"endOffset":4383},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4397,"endOffset":4401},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4567,"endOffset":4567},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:23 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:33 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:34 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:45 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:64 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:65 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:78 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:88 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:89 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:11:57.812Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:11:57.813Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n    function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  // Use the exists() function to check if the document exists\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:11:57.818Z] Jan 09, 2024 9:11:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:11:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:11:57.919Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:11:57.919Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":121,"column":46,"currentOffset":4321,"endOffset":4321},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":19,"currentOffset":4344,"endOffset":4353},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":29,"currentOffset":4354,"endOffset":4354},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":30,"currentOffset":4355,"endOffset":4355},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":41,"currentOffset":4366,"endOffset":4375},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":60,"currentOffset":4385,"endOffset":4385},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":61,"currentOffset":4386,"endOffset":4386},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":74,"currentOffset":4399,"endOffset":4408},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":84,"currentOffset":4409,"endOffset":4409},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":85,"currentOffset":4410,"endOffset":4410},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":123,"column":4,"currentOffset":4430,"endOffset":4430},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":126,"column":5,"currentOffset":4440,"endOffset":4444},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":130,"column":1,"currentOffset":4610,"endOffset":4610},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:121:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:122:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:122:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:122:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:123:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:126:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:130:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:12:21.496Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:12:21.497Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n    function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId)));\n    }\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:12:21.507Z] Jan 09, 2024 9:12:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:12:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:12:21.549Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:12:21.549Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":52,"currentOffset":4264,"endOffset":4264},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":62,"currentOffset":4274,"endOffset":4283},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":72,"currentOffset":4284,"endOffset":4284},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":73,"currentOffset":4285,"endOffset":4285},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":84,"currentOffset":4296,"endOffset":4305},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":103,"currentOffset":4315,"endOffset":4315},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":104,"currentOffset":4316,"endOffset":4316},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":117,"currentOffset":4329,"endOffset":4338},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":127,"currentOffset":4339,"endOffset":4339},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":128,"currentOffset":4340,"endOffset":4340},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":128,"column":1,"currentOffset":4541,"endOffset":4541},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:120:62 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:120:72 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:120:73 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:120:84 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:120:103 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:120:104 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:120:117 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:120:127 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:120:128 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:128:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:13:18.468Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:13:18.468Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n  function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:13:18.470Z] Jan 09, 2024 9:13:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:13:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:13:18.510Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:13:18.510Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4256,"endOffset":4256},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4279,"endOffset":4288},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4289,"endOffset":4289},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4290,"endOffset":4290},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4301,"endOffset":4310},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4320,"endOffset":4320},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4321,"endOffset":4321},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4334,"endOffset":4343},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4344,"endOffset":4344},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4345,"endOffset":4345},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4365,"endOffset":4365},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4375,"endOffset":4379},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4545,"endOffset":4545},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:13:19.731Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:13:19.731Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n  function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:13:19.738Z] Jan 09, 2024 9:13:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:13:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:13:19.841Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:13:19.841Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4256,"endOffset":4256},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4279,"endOffset":4288},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4289,"endOffset":4289},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4290,"endOffset":4290},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4301,"endOffset":4310},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4320,"endOffset":4320},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4321,"endOffset":4321},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4334,"endOffset":4343},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4344,"endOffset":4344},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4345,"endOffset":4345},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4365,"endOffset":4365},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4375,"endOffset":4379},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4545,"endOffset":4545},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:14:27.403Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:14:27.403Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:14:27.410Z] Jan 09, 2024 9:14:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:14:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:14:27.520Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:14:27.520Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:14:30.441Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:14:30.441Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        return candidateIdList.every((candidateId) => {\n        return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n        });\n    }\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:14:30.448Z] Jan 09, 2024 9:14:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:14:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:14:30.555Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:14:30.556Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":52,"currentOffset":4266,"endOffset":4266},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":23,"currentOffset":4293,"endOffset":4302},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":33,"currentOffset":4303,"endOffset":4303},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":34,"currentOffset":4304,"endOffset":4304},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":45,"currentOffset":4315,"endOffset":4324},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":64,"currentOffset":4334,"endOffset":4334},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":65,"currentOffset":4335,"endOffset":4335},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":78,"currentOffset":4348,"endOffset":4357},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":88,"currentOffset":4358,"endOffset":4358},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":89,"currentOffset":4359,"endOffset":4359},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":10,"currentOffset":4385,"endOffset":4385},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4399,"endOffset":4403},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4569,"endOffset":4569},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:52 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:23 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:33 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:34 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:45 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:64 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:65 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:78 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:88 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:89 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:10 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:15:33.854Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:15:33.854Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n     function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:15:33.855Z] Jan 09, 2024 9:15:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:15:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:15:33.881Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:15:33.882Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4259,"endOffset":4259},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4282,"endOffset":4291},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4292,"endOffset":4292},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4293,"endOffset":4293},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4304,"endOffset":4313},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4323,"endOffset":4323},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4324,"endOffset":4324},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4337,"endOffset":4346},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4347,"endOffset":4347},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4348,"endOffset":4348},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4368,"endOffset":4368},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4378,"endOffset":4382},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4548,"endOffset":4548},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:15:35.766Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:15:35.766Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n     function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:15:35.771Z] Jan 09, 2024 9:15:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:15:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:15:35.889Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:15:35.890Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4259,"endOffset":4259},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4282,"endOffset":4291},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4292,"endOffset":4292},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4293,"endOffset":4293},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4304,"endOffset":4313},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4323,"endOffset":4323},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4324,"endOffset":4324},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4337,"endOffset":4346},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4347,"endOffset":4347},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4348,"endOffset":4348},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4368,"endOffset":4368},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4378,"endOffset":4382},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4548,"endOffset":4548},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:15:59.879Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:15:59.879Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:15:59.884Z] Jan 09, 2024 9:15:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:15:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:00.001Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:00.001Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:01.617Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:01.618Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:01.628Z] Jan 09, 2024 9:16:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:01.727Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:01.727Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:02.012Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:02.012Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:02.020Z] Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:02.042Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:02.042Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:02.176Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:02.177Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:02.179Z] Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:02.233Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:02.234Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:02.338Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:02.339Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:02.340Z] Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:02.361Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:02.361Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:02.817Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:02.817Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:02.818Z] Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:02.838Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:02.838Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:02.868Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:02.869Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:02.870Z] Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:02.901Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:02.901Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:02.932Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:02.932Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:02.936Z] Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:02.954Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:02.954Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:02.995Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:02.996Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:03.006Z] Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:03.022Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:03.022Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:03.058Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:03.058Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:03.070Z] Jan 09, 2024 9:16:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:03.090Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:03.090Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:03.150Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:03.150Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:03.154Z] Jan 09, 2024 9:16:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:03.173Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:03.173Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:04.572Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:04.572Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:04.582Z] Jan 09, 2024 9:16:04 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:04 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:04.669Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:04.669Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":125,"column":5,"currentOffset":4373,"endOffset":4377},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":129,"column":1,"currentOffset":4543,"endOffset":4543},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:125:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:129:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:10.265Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:10.265Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  return candidateIdList.every((candidateId) => {\n    return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  });\n  return true;\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:10.271Z] Jan 09, 2024 9:16:10 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:10 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:10.320Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:10.320Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":120,"column":46,"currentOffset":4254,"endOffset":4254},"description":"Unexpected '='.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":19,"currentOffset":4277,"endOffset":4286},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":29,"currentOffset":4287,"endOffset":4287},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":30,"currentOffset":4288,"endOffset":4288},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":41,"currentOffset":4299,"endOffset":4308},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":60,"currentOffset":4318,"endOffset":4318},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":61,"currentOffset":4319,"endOffset":4319},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":74,"currentOffset":4332,"endOffset":4341},"description":"Missing 'match' keyword before path.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":84,"currentOffset":4342,"endOffset":4342},"description":"Forward slash '/' found where identifier or binding expected.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":121,"column":85,"currentOffset":4343,"endOffset":4343},"description":"mismatched input '$' expecting {'{', '/', PATH_SEGMENT}","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":122,"column":4,"currentOffset":4363,"endOffset":4363},"description":"Unexpected ')'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":126,"column":5,"currentOffset":4388,"endOffset":4392},"description":"Unexpected 'allow'.","severity":"ERROR"},{"sourcePosition":{"fileName":"security.rules","line":130,"column":1,"currentOffset":4558,"endOffset":4558},"description":"Unexpected '}'.","severity":"ERROR"}]}
[warn] ⚠  firestore.rules:120:46 - ERROR Unexpected '='. 
[warn] ⚠  firestore.rules:121:19 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:29 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:30 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:41 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:60 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:61 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:121:74 - ERROR Missing 'match' keyword before path. 
[warn] ⚠  firestore.rules:121:84 - ERROR Forward slash '/' found where identifier or binding expected. 
[warn] ⚠  firestore.rules:121:85 - ERROR mismatched input '$' expecting {'{', '/', PATH_SEGMENT} 
[warn] ⚠  firestore.rules:122:4 - ERROR Unexpected ')'. 
[warn] ⚠  firestore.rules:126:5 - ERROR Unexpected 'allow'. 
[warn] ⚠  firestore.rules:130:1 - ERROR Unexpected '}'. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:13.151Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:13.151Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  // return candidateIdList.every((candidateId) => {\n  //   return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  // });\n  return true;\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:13.152Z] Jan 09, 2024 9:16:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:13.264Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:13.264Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":11,"column":14,"currentOffset":282,"endOffset":300},"description":"Unused function: isValidElectionData.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":113,"column":29,"currentOffset":3924,"endOffset":3928},"description":"Unused variable: value.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":119,"column":47,"currentOffset":4178,"endOffset":4192},"description":"Unused variable: candidateIdList.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":119,"column":64,"currentOffset":4195,"endOffset":4204},"description":"Unused variable: electionId.","severity":"WARNING"}]}
[warn] ⚠  firestore.rules:11:14 - WARNING Unused function: isValidElectionData. 
[warn] ⚠  firestore.rules:113:29 - WARNING Unused variable: value. 
[warn] ⚠  firestore.rules:119:47 - WARNING Unused variable: candidateIdList. 
[warn] ⚠  firestore.rules:119:64 - WARNING Unused variable: electionId. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:14.573Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:14.573Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\nfunction allStringsExistInCandidateCollection(candidateIdList, electionId) {\n  // return candidateIdList.every((candidateId) => {\n  //   return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n  // });\n  return true;\n}\n\n    allow read: if request.auth.uid != null;\n    allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n    allow read, write: if isAdmin();\n  }\n}\n}\n"}]}}
[debug] [2024-01-09T21:16:14.583Z] Jan 09, 2024 9:16:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:14.714Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:14.715Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":11,"column":14,"currentOffset":282,"endOffset":300},"description":"Unused function: isValidElectionData.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":113,"column":29,"currentOffset":3924,"endOffset":3928},"description":"Unused variable: value.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":119,"column":47,"currentOffset":4178,"endOffset":4192},"description":"Unused variable: candidateIdList.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":119,"column":64,"currentOffset":4195,"endOffset":4204},"description":"Unused variable: electionId.","severity":"WARNING"}]}
[warn] ⚠  firestore.rules:11:14 - WARNING Unused function: isValidElectionData. 
[warn] ⚠  firestore.rules:113:29 - WARNING Unused variable: value. 
[warn] ⚠  firestore.rules:119:47 - WARNING Unused variable: candidateIdList. 
[warn] ⚠  firestore.rules:119:64 - WARNING Unused variable: electionId. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:16:18.464Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:16:18.464Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        // return candidateIdList.every((candidateId) => {\n        //   return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n        // });\n        return true;\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:16:18.468Z] Jan 09, 2024 9:16:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:16:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:16:18.554Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:16:18.554Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":11,"column":14,"currentOffset":282,"endOffset":300},"description":"Unused function: isValidElectionData.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":113,"column":29,"currentOffset":3924,"endOffset":3928},"description":"Unused variable: value.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":119,"column":53,"currentOffset":4184,"endOffset":4198},"description":"Unused variable: candidateIdList.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":119,"column":70,"currentOffset":4201,"endOffset":4210},"description":"Unused variable: electionId.","severity":"WARNING"}]}
[warn] ⚠  firestore.rules:11:14 - WARNING Unused function: isValidElectionData. 
[warn] ⚠  firestore.rules:113:29 - WARNING Unused variable: value. 
[warn] ⚠  firestore.rules:119:53 - WARNING Unused variable: candidateIdList. 
[warn] ⚠  firestore.rules:119:70 - WARNING Unused variable: electionId. 
[info] ✔  firestore: Rules updated. 
[info] i  firestore: Change detected, updating rules... 
[debug] [2024-01-09T21:18:55.938Z] >>> [apiv2][query] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules [none]
[debug] [2024-01-09T21:18:55.938Z] >>> [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"ignore_errors":true,"rules":{"files":[{"name":"security.rules","content":"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n\n    function isAdmin() {\n      let userDoc = get(/databases/$(database)/documents/user/$(request.auth.uid));\n      return userDoc != null && userDoc.data.role == 'admin';\n    }\n\n    function isValidElectionData(data){\n      return data.keys().hasAll(['name', 'description', 'startDate', 'endDate', 'candidates']) &&\n      data.name is string && data.name.size() > 0 && data.name.size() < 100 &&\n      data.description is string && data.description.size() > 0 && data.description.size() < 100 &&\n      data.startDate is timestamp &&\n      data.endDate is timestamp &&\n      data.candidates is list && data.candidates.size() > 0 && data.candidates.size() < 100;\n    }\n    // Need for stripe\n    match /customers/{uid} {\n      allow read, write: if request.auth.uid == uid;\n\n      match /checkout_sessions/{id} {\n        allow read, write: if request.auth.uid == uid;\n      }\n\n      match /subscriptions/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n\n      match /payments/{id} {\n        allow read: if request.auth.uid == uid;\n      }\n    }\n\n    // Define rules for the 'products' collection\n    match /products/{id} {\n      allow read: if true;\n\n      match /prices/{id} {\n        allow read: if true;\n      }\n\n      match /tax_rates/{id} {\n        allow read: if true;\n      }\n    }\n\n    // User document rules\n    match /user/{userId} {\n      // Function to validate address lines\n      function isValidAddressLines(addressLines) {\n        return addressLines is list &&\n        addressLines.size() == 2 &&\n        addressLines[0] is string &&\n        addressLines[0].size() <= 50 &&\n        addressLines[1] is string &&\n        addressLines[1].size() <= 50;\n      }\n\n      // Function to validate user data\n      function isValidUserData(user) {\n        return user is map && user.keys().hasAll(['firstName', 'lastName', 'dob', 'address', 'role']) &&\n        user.firstName is string && user.firstName.size() <= 50 &&\n        user.lastName is string && user.lastName.size() <= 50 &&\n        user.dob is string &&\n        user.address is map &&\n        isValidAddressLines(user.address.addressLines) &&\n        user.address.postcode is string && user.address.postcode.size() <= 50 &&\n        user.address.locality is string && user.address.locality.size() <= 50 &&\n        user.address.regionCode is string &&\n        user.role is list && user.role.size() == 0;\n      }\n      // Allowing write access if the user data is valid and the UID matches\n      allow write: if isValidUserData(request.resource.data) && request.auth.uid == userId;\n\n      // Allowing read access if the UID matches\n      allow read: if request.auth.uid == userId;\n      allow write: if isAdmin();\n    }\n\n    // Election document rules\n    match /elections {\n      allow list: if request.auth != null;\n    }\n    // Election document rules for a specific electionId\n    match /election/{electionId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n    // Candidate document rules within a specific election\n    match /election/{electionId}/candidate/{candidateId} {\n      allow read: if request.auth.uid != null;\n      allow write: if isAdmin();\n      allow list: if request.auth != null;\n    }\n\n\n\n    // Vote document rules within a specific election and user\n    match /election/{electionId}/vote/{uid} {\n      // Function to validate vote data\n      function isValidVoteData(data) {\n        return data.keys().hasAll(['candidateId']) &&\n        data.candidateId is list &&\n        isStringList(data.candidateId) &&\n        allStringsExistInCandidateCollection(data.candidateId, electionId) &&\n        request.auth.uid == uid;    // Ensure that the vote is associated with the correct user\n      }\n\n    // Helper function to check if a value is a list of strings\n      function isStringList(value) {\n        // return (value is list) && value.every((item) => item is string);\n        return true;\n      }\n\n    // Helper function to check if all strings in the list exist in the candidate collection\n      function allStringsExistInCandidateCollection(candidateIdList, electionId) {\n        // return candidateIdList.every((candidateId) => {\n        //   return exists(/databases/$(database)/documents/election/$(electionId)/candidate/$(candidateId));\n        // });\n        return true;\n      }\n\n      allow read: if request.auth.uid != null;\n      allow write: if request.auth.uid != null && isValidVoteData(request.resource.data);\n      allow read, write: if isAdmin();\n    }\n  }\n}\n"}]}}
[debug] [2024-01-09T21:18:55.940Z] Jan 09, 2024 9:18:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
INFO: Detected non-HTTP/2 connection.
 {"metadata":{"emulator":{"name":"firestore"},"message":"Jan 09, 2024 9:18:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n"}}
[debug] [2024-01-09T21:18:55.991Z] <<< [apiv2][status] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules 200
[debug] [2024-01-09T21:18:55.992Z] <<< [apiv2][body] PUT http://127.0.0.1:8081/emulator/v1/projects/ptate-df901:securityRules {"issues":[{"sourcePosition":{"fileName":"security.rules","line":11,"column":14,"currentOffset":282,"endOffset":300},"description":"Unused function: isValidElectionData.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":114,"column":29,"currentOffset":3957,"endOffset":3961},"description":"Unused variable: value.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":53,"currentOffset":4217,"endOffset":4231},"description":"Unused variable: candidateIdList.","severity":"WARNING"},{"sourcePosition":{"fileName":"security.rules","line":120,"column":70,"currentOffset":4234,"endOffset":4243},"description":"Unused variable: electionId.","severity":"WARNING"}]}
[warn] ⚠  firestore.rules:11:14 - WARNING Unused function: isValidElectionData. 
[warn] ⚠  firestore.rules:114:29 - WARNING Unused variable: value. 
[warn] ⚠  firestore.rules:120:53 - WARNING Unused variable: candidateIdList. 
[warn] ⚠  firestore.rules:120:70 - WARNING Unused variable: electionId. 
[info] ✔  firestore: Rules updated. 
